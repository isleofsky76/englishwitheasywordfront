// 단어장 데이터 - 날짜별로 구성
const wordsByDate = {
    "20250925": {
        "title": "지미 키멜 복귀(20250925)",
        "words": [
            {
                "word": "return",
                "korean_pronunciation": "리턴",
                "meaning": "복귀, 돌아옴",
                "example_sentence": "Jimmy Kimmel’s return to ABC drew nationwide attention.",
                "korean_translation": "[지미 키멜의 ABC 복귀(return)는 전국적인 관심을 끌었다(drew).]",
                "key_words": ["return"]
              },
            {
                "word": "suspend",
                "korean_pronunciation": "서스펜드",
                "meaning": "중단하다, 정지시키다",
                "example_sentence": "ABC suspended Jimmy Kimmel's show after the controversy.",
                "korean_translation": "[논란(controversy) 이후 ABC는 지미 키멜의 쇼를 중단했다(suspended).]",
                "key_words": ["suspended"]
              },
              {
                "word": "spark",
                "korean_pronunciation": "스파크",
                "meaning": "촉발하다, 불을 일으키다",
                "example_sentence": "The suspension sparked a nationwide free speech controversy.",
                "korean_translation": "[그 중단(suspension)은 전국적인 표현의 자유 논란을 촉발했다(sparked).]",
                "key_words": ["sparked"]
              },
              {
                "word": "argue",
                "korean_pronunciation": "아규",
                "meaning": "주장하다, 논쟁하다",
                "example_sentence": "Many argued that free speech was under threat.",
                "korean_translation": "[많은 사람들이 표현의 자유(free speech)가 위협받고 있다고(under threat) 주장했다(argued).]",
                "key_words": ["argued"]
              },
            
              {
                "word": "broadcast",
                "korean_pronunciation": "브로드캐스트",
                "meaning": "방송하다",
                "example_sentence": "The network could not broadcast the episode in many cities.",
                "korean_translation": "[방송사(network)는 많은 도시에서 그 에피소드를 방송할 수 없었다(could not broadcast).]",
                "key_words": ["broadcast"]
              },
              {
                "word": "sign",
                "korean_pronunciation": "사인",
                "meaning": "서명하다, 사인하다",
                "example_sentence": "Outraged fans signed an online petition to bring the show back.",
                "korean_translation": "[분노한 팬들(outraged fans)은 프로그램 복귀를 요구하는 온라인 청원(petition)에 서명했다(signed).]",
                "key_words": ["signed"]
              },
              {
                "word": "cancel",
                "korean_pronunciation": "캔슬",
                "meaning": "취소하다, 중단하다",
                "example_sentence": "Some viewers canceled their Disney subscriptions in protest.",
                "korean_translation": "[일부 시청자들(some viewers)은 항의의 표시로(in protest) 디즈니 구독을 취소했다(canceled).]",
                "key_words": ["canceled"]
              },
              {
                "word": "threaten",
                "korean_pronunciation": "스레튼",
                "meaning": "위협하다",
                "example_sentence": "The boycott threatened millions in advertising revenue.",
                "korean_translation": "[그 보이콧(boycott)은 수백만 달러의 광고 수익을 위협했다(threatened).]",
                "key_words": ["threatened"]
              },
              {
                "word": "draw",
                "korean_pronunciation": "드로",
                "meaning": "끌다, 이끌다",
                "example_sentence": "Jimmy Kimmel's return drew nationwide attention.",
                "korean_translation": "지미 키멜의 복귀는 전국적인 관심(nationwide attention)을 끌었다(drew).]",
                "key_words": ["drew"]
              },
             
             
        ]
    },
    "20250919": {
        "title": "엔비디아 인텔에 투자(20250918)",
        "words": [
            
            {
                "word": "shore up",
                "korean_pronunciation": "쇼어 업",
                "meaning": "강화하다, 떠받치다",
                "example_sentence": "The investment shores up Intel's struggling finances.",
                "korean_translation": "이 투자는 인텔의 어려운 재정 상황을 안정시킨다.",
                "key_words": ["shores up"]
            },
            {
                "word": "foundry",
                "korean_pronunciation": "파운드리",
                "meaning": "반도체 위탁 생산 사업",
                "example_sentence": "Intel's foundry ambition faces tough competition from TSMC.",
                "korean_translation": "인텔의 파운드리 야망은 TSMC와의 치열한 경쟁에 직면해 있다.",
                "key_words": ["foundry", "manufacturing", "semiconductors"]
            },
            {
                "word": "stake",
                "korean_pronunciation": "스테이크",
                "meaning": "지분, 이해관계",
                "example_sentence": "The U.S. government took a 10% stake in Intel.",
                "korean_translation": "미국 정부는 인텔의 10% 지분을 취득했다.",
                "key_words": ["stake", "equity", "ownership"]
            },
            {
                "word": "premarket",
                "korean_pronunciation": "프리마켓",
                "meaning": "장전 거래",
                "example_sentence": "Intel's shares jumped 30% in premarket trading.",
                "korean_translation": "인텔 주가는 장전 거래에서 30% 급등했다.",
                "key_words": ["premarket", "trading", "before market open"]
            },
            {
                "word": "collaboration",
                "korean_pronunciation": "콜래버레이션",
                "meaning": "협력",
                "example_sentence": "The companies announced a collaboration on new chip designs.",
                "korean_translation": "양사는 새로운 칩 설계에 대한 협력을 발표했다.",
                "key_words": ["collaboration", "cooperation", "joint work"]
            },
            {
                "word": "revive",
                "korean_pronunciation": "리바이브",
                "meaning": "되살리다, 회복시키다",
                "example_sentence": "The new deals may revive Intel's weakening position.",
                "korean_translation": "새로운 거래들이 인텔의 약화된 입지를 되살릴 수 있다.",
                "key_words": ["revive", "restore", "resuscitate"]
            },
            {
                "word": "struggling",
                "korean_pronunciation": "스트러글링",
                "meaning": "고군분투하는",
                "example_sentence": "Intel has been struggling to keep up with rivals.",
                "korean_translation": "인텔은 경쟁사들을 따라잡기 위해 고군분투해 왔다.",
                "key_words": ["struggling", "fighting", "suffering"]
            },
            {
                "word": "erode",
                "korean_pronunciation": "이로드",
                "meaning": "침식하다, 약화시키다",
                "example_sentence": "Intel's delays eroded confidence among investors.",
                "korean_translation": "인텔의 지연은 투자자들의 신뢰를 약화시켰다.",
                "key_words": ["erode", "weaken", "diminish"]
            },
            {
                "word": "boost",
                "korean_pronunciation": "부스트",
                "meaning": "끌어올리다, 촉진하다",
                "example_sentence": "The government aims to boost Intel's manufacturing capacity.",
                "korean_translation": "정부는 인텔의 제조 역량을 끌어올리려 한다.",
                "key_words": ["boost", "increase", "promote"]
            },
            
        ]
    },
    "20250920": {
        "title": "지미 키멜 토크쇼 무기한 중단(20250919)",
        "words": [
            {
                "word": "late-night",
                "korean_pronunciation": "레이트 나이트",
                "meaning": "심야의, 늦은 밤의",
                "example_sentence": "The late-night show has been a staple of American television for decades.",
                "korean_translation": "그 심야 프로그램은 수십 년간 미국 텔레비전의 주류였습니다.",
                "key_words": ["late-night", "evening", "nighttime"]
            },
            {
                "word": "controversy",
                "korean_pronunciation": "컨트로버시",
                "meaning": "논란, 논쟁",
                "example_sentence": "The controversy surrounding the comedian's comments led to widespread criticism.",
                "korean_translation": "코미디언의 발언을 둘러싼 논란이 광범위한 비판을 불러왔습니다.",
                "key_words": ["controversy", "dispute", "scandal"]
            },
            {
                "word": "backlash",
                "korean_pronunciation": "백래시",
                "meaning": "반발, 역풍",
                "example_sentence": "The network faced severe backlash from viewers and advertisers.",
                "korean_translation": "방송사는 시청자와 광고주들로부터 심한 반발에 직면했습니다.",
                "key_words": ["backlash", "reaction", "opposition"]
            },
            {
                "word": "indefinite",
                "korean_pronunciation": "인디피닛",
                "meaning": "무기한의, 불확정한",
                "example_sentence": "The show has been suspended for an indefinite period.",
                "korean_translation": "그 프로그램은 무기한 중단되었습니다.",
                "key_words": ["indefinite", "unlimited", "uncertain"]
            },
            {
                "word": "suspension",
                "korean_pronunciation": "서스펜션",
                "meaning": "중단, 정지",
                "example_sentence": "The suspension came after weeks of mounting pressure.",
                "korean_translation": "중단은 수 주간의 압력 증가 후에 일어났습니다.",
                "key_words": ["suspension", "halt", "pause"]
            },
            {
                "word": "pressure",
                "korean_pronunciation": "프레셔",
                "meaning": "압력, 압박",
                "example_sentence": "Political and social pressure forced the network's decision.",
                "korean_translation": "정치적이고 사회적인 압력이 방송사의 결정을 강요했습니다.",
                "key_words": ["pressure", "stress", "force"]
            },
            {
                "word": "outcry",
                "korean_pronunciation": "아웃크라이",
                "meaning": "강력한 항의, 외침",
                "example_sentence": "Public outcry grew louder as more details emerged.",
                "korean_translation": "더 많은 세부사항이 드러나면서 대중의 강력한 항의가 커졌습니다.",
                "key_words": ["outcry", "protest", "uproar"]
            },
            {
                "word": "ratings",
                "korean_pronunciation": "레이팅스",
                "meaning": "시청률, 등급",
                "example_sentence": "The show's ratings plummeted following the controversy.",
                "korean_translation": "논란 이후 그 프로그램의 시청률이 급락했습니다.",
                "key_words": ["ratings", "viewership", "audience"]
            },
            {
                "word": "advertisers",
                "korean_pronunciation": "애드버타이저스",
                "meaning": "광고주들",
                "example_sentence": "Several major advertisers pulled their commercials from the show.",
                "korean_translation": "여러 주요 광고주들이 그 프로그램에서 광고를 철수했습니다.",
                "key_words": ["advertisers", "sponsors", "commercial"]
            },
           
            {
                "word": "insensitive",
                "korean_pronunciation": "인센시티브",
                "meaning": "무분별한, 민감하지 않은",
                "example_sentence": "Many found his comments insensitive and inappropriate.",
                "korean_translation": "많은 사람들이 그의 발언을 무분별하고 부적절하다고 생각했습니다.",
                "key_words": ["insensitive", "tactless", "crude"]
            },
            {
                "word": "inappropriate",
                "korean_pronunciation": "인어프로프리에이트",
                "meaning": "부적절한, 적절하지 않은",
                "example_sentence": "The network deemed the content inappropriate for broadcast.",
                "korean_translation": "방송사는 그 내용을 방송하기에 부적절하다고 판단했습니다.",
                "key_words": ["inappropriate", "unsuitable", "improper"]
            },
          
            {
                "word": "incident",
                "korean_pronunciation": "인시던트",
                "meaning": "사건, 사고",
                "example_sentence": "The incident has sparked a broader conversation about media responsibility.",
                "korean_translation": "그 사건은 미디어의 책임에 대한 더 넓은 논의를 촉발했습니다.",
                "key_words": ["incident", "event", "occurrence"]
            },
            {
                "word": "undermine",
                "korean_pronunciation": "언더마인",
                "meaning": "약화시키다, 훼손하다",
                "example_sentence": "Constant criticism can undermine the public’s trust in institutions.",
                "korean_translation": "지속적인 비판은 대중의 공공기관에 대한 신뢰를 약화시킬 수 있다.",
                "key_words": ["undermine", "weaken", "damage"]
            },
            {
                "word": "escalate",
                "korean_pronunciation": "에스컬레이트",
                "meaning": "격화되다, 확대되다",
                "example_sentence": "The controversy escalated after the remarks spread on social media.",
                "korean_translation": "그 발언이 소셜 미디어에 퍼지면서 논란이 격화되었다.",
                "key_words": ["escalated", "intensify", "grow"]
            },
            {
                "word": "intervene",
                "korean_pronunciation": "인터빈",
                "meaning": "개입하다, 중재하다",
                "example_sentence": "The regulator decided to intervene to prevent further market chaos.",
                "korean_translation": "규제 당국은 추가적인 시장 혼란을 막기 위해 개입하기로 했다.",
                "key_words": ["intervene", "mediate", "step in"]
            }
        ]
    }
};

let currentWordIndex = 0;

// 키워드 하이라이트 함수
function highlightKeywords(text, keywords) {
    if (!keywords || keywords.length === 0) return text;
    
    let highlightedText = text;
    keywords.forEach(keyword => {
        const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
        highlightedText = highlightedText.replace(regex, `<span style="color: red; font-weight: bold;">${keyword}</span>`);
    });
    return highlightedText;
}

// DOM 요소들
const wordContainer = document.getElementById('article-container');
const wordPopup = document.getElementById('wordPopup');
const popupWord = document.querySelector('.popup-word');
const popupMeaning = document.querySelector('.popup-meaning');
const popupClose = document.querySelector('.popup-close');

// 현재 날짜 설정 (YYYYMMDD 형식)
function getCurrentDate() {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    return `${year}${month}${day}`;
}

// 현재 날짜의 단어들 가져오기
function getWordsForDate(date) {
    return wordsByDate[date]?.words || [];
}

// 현재 날짜의 제목 가져오기
function getTitleForDate(date) {
    return wordsByDate[date]?.title || `뉴스 단어 (${date})`;
}

// 사용 가능한 날짜 목록 가져오기 (최신 날짜부터)
function getAvailableDates() {
    return Object.keys(wordsByDate).sort().reverse();
}

// 모든 단어 표시 (모든 날짜를 아래로 쭉 나열)
function displayAllWords() {
    const availableDates = getAvailableDates();
    let allWordsHTML = '';
    
    availableDates.forEach(date => {
        const words = getWordsForDate(date);
        const title = getTitleForDate(date);
        let wordsText = '';
        
        if (words.length > 0) {
            words.forEach((word, index) => {
                wordsText += `<div class="word-with-underline">
                    <span class="word-number">${index + 1}.</span> 
                    <span class="word-part">${word.word}</span> / 
                    <span class="word-part">${word.korean_pronunciation}</span> / 
                    <span class="word-part">${word.meaning}</span>
                    ${word.example_sentence ? `<br><span class="word-part" style="padding-left: 2.0em;">${highlightKeywords(word.example_sentence, word.key_words || [])}</span>` : ''}
                    ${word.korean_translation ? `<br><span class="word-part" style="padding-left: 2.0em;">(${word.korean_translation})</span>` : ''}
                </div>`;
            });
            
            allWordsHTML += `
                <div class="words-title">${title}</div>
                <div class="words-text">${wordsText}</div>
                <div class="date-spacing"></div>
            `;
        }
    });
    
    wordContainer.innerHTML = allWordsHTML;
}

// 초기화
function init() {
    console.log("JavaScript가 로드되었습니다!");
    displayAllWords();
}

// 이벤트 리스너 등록
document.addEventListener('DOMContentLoaded', function() {
    // 단어장 초기화
    init();
    
    // Home 링크 클릭 이벤트
    const homeLink = document.querySelector('.nav-link[href="https://englisheasystudy.com/"]');
    if (homeLink) {
        homeLink.addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = 'https://englisheasystudy.com/';
        });
    }
    
    // 팝업 관련 이벤트
    if (popupClose) {
        popupClose.addEventListener('click', closePopup);
    }
    
    // 팝업 외부 클릭 시 닫기
    if (wordPopup) {
        wordPopup.addEventListener('click', function(e) {
            if (e.target === wordPopup) {
                closePopup();
            }
        });
    }
});

// 팝업 닫기
function closePopup() {
    if (wordPopup) {
        wordPopup.style.display = 'none';
    }
}

// 키보드 단축키
document.addEventListener('keydown', function(e) {
    // Escape로 팝업 닫기
    if (e.key === 'Escape') {
        closePopup();
    }
});
