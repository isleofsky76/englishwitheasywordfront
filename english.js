const wordsByDate = {
   
    "20250911": [
        {
            "word": "detention",
            "korean_pronunciation": "디텐션",
            "english_pronunciation": "/dɪˈtenʃən/",
            "meaning": "구금, 억류",
            "language": "en-GB"
        },
        {
            "word": "raid",
            "korean_pronunciation": "레이드",
            "english_pronunciation": "/reɪd/",
            "meaning": "급습, 단속",
            "language": "en-GB"
        },
        {
            "word": "immigration",
            "korean_pronunciation": "이미그레이션",
            "english_pronunciation": "/ˌɪmɪˈɡreɪʃən/",
            "meaning": "이민",
            "language": "en-GB"
        },
        {
            "word": "unauthorized",
            "korean_pronunciation": "언오소라이즈드",
            "english_pronunciation": "/ʌnˈɔːθəraɪzd/",
            "meaning": "무단의, 불법의",
            "language": "en-GB"
        },
        {
            "word": "probe",
            "korean_pronunciation": "프로브",
            "english_pronunciation": "/prəʊb/",
            "meaning": "조사, 수사",
            "language": "en-GB"
        },
        {
            "word": "venture",
            "korean_pronunciation": "벤처",
            "english_pronunciation": "/ˈventʃər/",
            "meaning": "투자, 사업",
            "language": "en-GB"
        },
        {
            "word": "construction",
            "korean_pronunciation": "컨스트럭션",
            "english_pronunciation": "/kənˈstrʌkʃən/",
            "meaning": "건설",
            "language": "en-GB"
        },
        {
            "word": "supplier",
            "korean_pronunciation": "서플라이어",
            "english_pronunciation": "/səˈplaɪər/",
            "meaning": "공급업체",
            "language": "en-GB"
        },
        {
            "word": "subcontractor",
            "korean_pronunciation": "서브컨트랙터",
            "english_pronunciation": "/ˌsʌbkənˈtræktər/",
            "meaning": "하청업체",
            "language": "en-GB"
        },
        {
            "word": "facility",
            "korean_pronunciation": "퍼실리티",
            "english_pronunciation": "/fəˈsɪləti/",
            "meaning": "시설, 공장",
            "language": "en-GB"
        },
        {
            "word": "manufacturing",
            "korean_pronunciation": "매뉴팩처링",
            "english_pronunciation": "/ˌmænjuˈfæktʃərɪŋ/",
            "meaning": "제조업",
            "language": "en-GB"
        },
        {
            "word": "multibillion",
            "korean_pronunciation": "멀티빌리언",
            "english_pronunciation": "/ˌmʌltiˈbɪljən/",
            "meaning": "수십억의",
            "language": "en-GB"
        },
        {
            "word": "investment",
            "korean_pronunciation": "인베스트먼트",
            "english_pronunciation": "/ɪnˈvestmənt/",
            "meaning": "투자",
            "language": "en-GB"
        },
        {
            "word": "waiver",
            "korean_pronunciation": "웨이버",
            "english_pronunciation": "/ˈweɪvər/",
            "meaning": "면제",
            "language": "en-GB"
        },
        {
            "word": "program",
            "korean_pronunciation": "프로그램",
            "english_pronunciation": "/ˈprəʊɡræm/",
            "meaning": "프로그램",
            "language": "en-GB"
        },
        {
            "word": "business",
            "korean_pronunciation": "비즈니스",
            "english_pronunciation": "/ˈbɪznəs/",
            "meaning": "비즈니스, 사업",
            "language": "en-GB"
        },
        {
            "word": "tourist",
            "korean_pronunciation": "투어리스트",
            "english_pronunciation": "/ˈtʊərɪst/",
            "meaning": "관광객",
            "language": "en-GB"
        },
        {
            "word": "permit",
            "korean_pronunciation": "퍼밋",
            "english_pronunciation": "/pərˈmɪt/",
            "meaning": "허가",
            "language": "en-GB"
        },
        {
            "word": "compliance",
            "korean_pronunciation": "컴플라이언스",
            "english_pronunciation": "/kəmˈplaɪəns/",
            "meaning": "준수, 법규 이행",
            "language": "en-GB"
        },
        {
            "word": "regulation",
            "korean_pronunciation": "레귤레이션",
            "english_pronunciation": "/ˌreɡjuˈleɪʃən/",
            "meaning": "규제",
            "language": "en-GB"
        },
        {
            "word": "gray",
            "korean_pronunciation": "그레이",
            "english_pronunciation": "/ɡreɪ/",
            "meaning": "회색의, 모호한",
            "language": "en-GB"
        },
        {
            "word": "area",
            "korean_pronunciation": "에어리어",
            "english_pronunciation": "/ˈeəriə/",
            "meaning": "영역, 지역",
            "language": "en-GB"
        },
        {
            "word": "chief",
            "korean_pronunciation": "치프",
            "english_pronunciation": "/tʃiːf/",
            "meaning": "최고의, 책임자",
            "language": "en-GB"
        },
      
        {
            "word": "officer",
            "korean_pronunciation": "오피서",
            "english_pronunciation": "/ˈɒfɪsər/",
            "meaning": "관리자, 책임자",
            "language": "en-GB"
        },
        {
            "word": "dispatch",
            "korean_pronunciation": "디스패치",
            "english_pronunciation": "/dɪˈspætʃ/",
            "meaning": "파견하다",
            "language": "en-GB"
        },
        {
            "word": "suspend",
            "korean_pronunciation": "서스펜드",
            "english_pronunciation": "/səˈspend/",
            "meaning": "중단하다",
            "language": "en-GB"
        },
        {
            "word": "videoconference",
            "korean_pronunciation": "비디오컨퍼런스",
            "english_pronunciation": "/ˈvɪdiəʊˌkɒnfərəns/",
            "meaning": "화상 회의",
            "language": "en-GB"
        },
        {
            "word": "consular",
            "korean_pronunciation": "컨슐러",
            "english_pronunciation": "/ˈkɒnsjələr/",
            "meaning": "영사의",
            "language": "en-GB"
        },
        {
            "word": "services",
            "korean_pronunciation": "서비스즈",
            "english_pronunciation": "/ˈsɜːvɪsɪz/",
            "meaning": "서비스",
            "language": "en-GB"
        },
        {
            "word": "fallout",
            "korean_pronunciation": "폴아웃",
            "english_pronunciation": "/ˈfɔːlaʊt/",
            "meaning": "여파, 부정적 영향",
            "language": "en-GB"
        },
        {
            "word": "instability",
            "korean_pronunciation": "인스터빌리티",
            "english_pronunciation": "/ˌɪnstəˈbɪləti/",
            "meaning": "불안정",
            "language": "en-GB"
        },
        {
            "word": "uncertainty",
            "korean_pronunciation": "언서턴티",
            "english_pronunciation": "/ʌnˈsɜːtənti/",
            "meaning": "불확실성",
            "language": "en-GB"
        },
        {
            "word": "navigate",
            "korean_pronunciation": "내비게이트",
            "english_pronunciation": "/ˈnævɪɡeɪt/",
            "meaning": "헤쳐 나가다, 대응하다",
            "language": "en-GB"
        },
        {
            "word": "monitor",
            "korean_pronunciation": "모니터",
            "english_pronunciation": "/ˈmɒnɪtər/",
            "meaning": "면밀히 관찰하다",
            "language": "en-GB"
        }
    ]
};

let currentWordIndex = 0;

// DOM 요소들
const wordContainer = document.getElementById('article-container');
const wordPopup = document.getElementById('wordPopup');
const popupWord = document.querySelector('.popup-word');
const popupMeaning = document.querySelector('.popup-meaning');
const popupClose = document.querySelector('.popup-close');

// 현재 날짜 설정 (YYYYMMDD 형식)
function getCurrentDate() {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    return `${year}${month}${day}`;
}

// 현재 날짜의 단어들 가져오기
function getWordsForDate(date) {
    return wordsByDate[date] || [];
}

// 사용 가능한 날짜 목록 가져오기
function getAvailableDates() {
    return Object.keys(wordsByDate).sort();
}


// 단어 음성 재생 (웹 TTS 사용)
function playWordAudio(word, language) {
    if ('speechSynthesis' in window) {
        // 기존 음성 중지
        speechSynthesis.cancel();
        
        const utterance = new SpeechSynthesisUtterance(word);
        
        // 언어 설정
        if (language === 'en-GB') {
            utterance.lang = 'en-GB';
        } else if (language === 'ko-KR') {
            utterance.lang = 'ko-KR';
        } else {
            utterance.lang = 'en-US';
        }
        
        // 음성 속도와 볼륨 설정
        utterance.rate = 0.8;
        utterance.volume = 1.0;
        utterance.pitch = 1.0;
        
        // 음성 재생
        speechSynthesis.speak(utterance);
    } else {
        console.error('Speech synthesis not supported');
        alert('이 브라우저는 음성 재생을 지원하지 않습니다.');
    }
}

// 모든 단어 표시 (모든 날짜를 아래로 쭉 나열)
function displayAllWords() {
    const availableDates = getAvailableDates();
    let allWordsHTML = '';
    
    availableDates.forEach(date => {
        const words = getWordsForDate(date);
        let wordsText = '';
        
        if (words.length > 0) {
            words.forEach((word, index) => {
                wordsText += `${index + 1}. <strong>${word.word}</strong> / ${word.korean_pronunciation} / ${word.english_pronunciation} / ${word.meaning} <button class="play-audio-btn" onclick="playWordAudio('${word.word}', '${word.language}')">🔊</button><br>`;
            });
            
            allWordsHTML += `
                <div class="words-title">오늘의 뉴스 단어(${date})</div>
                <div class="words-text">${wordsText}</div>
            `;
        }
    });
    
    wordContainer.innerHTML = allWordsHTML;
}




// 초기화
function init() {
    displayAllWords();
}

// 이벤트 리스너 등록
document.addEventListener('DOMContentLoaded', function() {
    // 단어장 초기화
    init();
    
    // 팝업 관련 이벤트
    if (popupClose) {
    popupClose.addEventListener('click', closePopup);
    }
    
    // 팝업 외부 클릭 시 닫기
    if (wordPopup) {
    wordPopup.addEventListener('click', function(e) {
        if (e.target === wordPopup) {
            closePopup();
        }
    });
    }
});

// 팝업 닫기
function closePopup() {
    if (wordPopup) {
    wordPopup.style.display = 'none';
    }
}

// 키보드 단축키
document.addEventListener('keydown', function(e) {
    // Escape로 팝업 닫기
    if (e.key === 'Escape') {
        closePopup();
    }
});

